<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AllDownloader - Ridzz Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        * { font-family: 'Inter', sans-serif; }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .platform-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .platform-card:hover { transform: translateY(-5px); }
        
        .platform-card.active {
            border: 3px solid #667eea;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }
        
        .input-focus:focus {
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.3);
            border-color: #667eea;
            outline: none;
        }
        
        .download-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transition: all 0.3s ease;
        }
        
        .download-btn:hover {
            transform: scale(1.02);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }
        
        .result-card { animation: slideUp 0.5s ease-out; }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top-color: #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin { to { transform: rotate(360deg); } }
        
        .api-badge {
            font-size: 0.65rem;
            padding: 0.15rem 0.5rem;
            border-radius: 9999px;
            font-weight: 600;
        }
        
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: white;
            padding: 16px 24px;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 1000;
        }
        
        .toast.show { transform: translateX(0); }
    </style>
</head>
<body class="antialiased">

    <!-- Toast -->
    <div id="toast" class="toast flex items-center space-x-3">
        <i id="toastIcon" class="fas fa-check-circle text-green-500 text-xl"></i>
        <span id="toastMessage" class="font-medium">Notifikasi</span>
    </div>

    <!-- Header -->
    <header class="glass-effect sticky top-0 z-50 shadow-lg">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-purple-600 to-blue-500 rounded-xl flex items-center justify-center text-white text-xl">
                        <i class="fas fa-cloud-download-alt"></i>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold text-gray-800">AllDownloader</h1>
                        <p class="text-xs text-gray-500">Developed by Ridzz</p>
                    </div>
                </div>
                <div class="flex items-center space-x-2">
                    <div class="w-2 h-2 rounded-full bg-green-500"></div>
                    <span class="text-xs text-gray-600">Ready</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main -->
    <main class="container mx-auto px-4 py-6 max-w-6xl">
        
        <!-- Hero -->
        <div class="text-center mb-8 text-white">
            <h2 class="text-3xl sm:text-4xl font-bold mb-3">Universal Downloader</h2>
            <p class="text-base opacity-90 max-w-xl mx-auto">
                Download dari berbagai platform dengan mudah
            </p>
        </div>

        <!-- Platform Selector -->
        <div class="glass-effect rounded-2xl p-4 sm:p-6 mb-6 shadow-2xl">
            <h3 class="text-base font-semibold text-gray-700 mb-4 text-center">Pilih Platform</h3>
            
            <div class="grid grid-cols-3 sm:grid-cols-4 lg:grid-cols-6 gap-3" id="platformContainer">
                <!-- YouTube -->
                <div class="platform-card active bg-white rounded-xl p-3 text-center shadow-md" data-platform="youtube">
                    <div class="w-10 h-10 mx-auto mb-1 bg-red-600 rounded-full flex items-center justify-center text-white text-lg">
                        <i class="fab fa-youtube"></i>
                    </div>
                    <span class="font-semibold text-gray-700 text-xs block">YouTube</span>
                    <div class="mt-1 flex justify-center gap-1">
                        <span class="api-badge bg-green-100 text-green-700">MP4</span>
                        <span class="api-badge bg-purple-100 text-purple-700">MP3</span>
                    </div>
                </div>

                <!-- Instagram -->
                <div class="platform-card bg-white rounded-xl p-3 text-center shadow-md" data-platform="instagram">
                    <div class="w-10 h-10 mx-auto mb-1 bg-gradient-to-tr from-yellow-400 via-red-500 to-purple-500 rounded-full flex items-center justify-center text-white text-lg">
                        <i class="fab fa-instagram"></i>
                    </div>
                    <span class="font-semibold text-gray-700 text-xs block">Instagram</span>
                    <div class="mt-1 flex justify-center">
                        <span class="api-badge bg-pink-100 text-pink-700">Scrape</span>
                    </div>
                </div>

                <!-- TikTok -->
                <div class="platform-card bg-white rounded-xl p-3 text-center shadow-md" data-platform="tiktok">
                    <div class="w-10 h-10 mx-auto mb-1 bg-black rounded-full flex items-center justify-center text-white text-lg">
                        <i class="fab fa-tiktok"></i>
                    </div>
                    <span class="font-semibold text-gray-700 text-xs block">TikTok</span>
                    <div class="mt-1 flex justify-center gap-1">
                        <span class="api-badge bg-blue-100 text-blue-700">API</span>
                    </div>
                </div>

                <!-- Twitter -->
                <div class="platform-card bg-white rounded-xl p-3 text-center shadow-md" data-platform="twitter">
                    <div class="w-10 h-10 mx-auto mb-1 bg-blue-400 rounded-full flex items-center justify-center text-white text-lg">
                        <i class="fab fa-twitter"></i>
                    </div>
                    <span class="font-semibold text-gray-700 text-xs block">Twitter</span>
                    <div class="mt-1 flex justify-center">
                        <span class="api-badge bg-blue-100 text-blue-700">API</span>
                    </div>
                </div>

                <!-- Pinterest -->
                <div class="platform-card bg-white rounded-xl p-3 text-center shadow-md" data-platform="pinterest">
                    <div class="w-10 h-10 mx-auto mb-1 bg-red-700 rounded-full flex items-center justify-center text-white text-lg">
                        <i class="fab fa-pinterest-p"></i>
                    </div>
                    <span class="font-semibold text-gray-700 text-xs block">Pinterest</span>
                    <div class="mt-1 flex justify-center">
                        <span class="api-badge bg-red-100 text-red-700">Scrape</span>
                    </div>
                </div>

                <!-- Spotify Search -->
                <div class="platform-card bg-white rounded-xl p-3 text-center shadow-md" data-platform="spotify">
                    <div class="w-10 h-10 mx-auto mb-1 bg-green-500 rounded-full flex items-center justify-center text-white text-lg">
                        <i class="fab fa-spotify"></i>
                    </div>
                    <span class="font-semibold text-gray-700 text-xs block">Music</span>
                    <div class="mt-1 flex justify-center">
                        <span class="api-badge bg-green-100 text-green-700">Search</span>
                    </div>
                </div>

                <!-- Facebook -->
                <div class="platform-card bg-white rounded-xl p-3 text-center shadow-md" data-platform="facebook">
                    <div class="w-10 h-10 mx-auto mb-1 bg-blue-600 rounded-full flex items-center justify-center text-white text-lg">
                        <i class="fab fa-facebook-f"></i>
                    </div>
                    <span class="font-semibold text-gray-700 text-xs block">Facebook</span>
                    <div class="mt-1 flex justify-center">
                        <span class="api-badge bg-blue-100 text-blue-700">API</span>
                    </div>
                </div>

                <!-- Google Drive -->
                <div class="platform-card bg-white rounded-xl p-3 text-center shadow-md" data-platform="gdrive">
                    <div class="w-10 h-10 mx-auto mb-1 bg-green-600 rounded-full flex items-center justify-center text-white text-lg">
                        <i class="fab fa-google-drive"></i>
                    </div>
                    <span class="font-semibold text-gray-700 text-xs block">GDrive</span>
                    <div class="mt-1 flex justify-center">
                        <span class="api-badge bg-green-100 text-green-700">Direct</span>
                    </div>
                </div>

                <!-- GitHub -->
                <div class="platform-card bg-white rounded-xl p-3 text-center shadow-md" data-platform="github">
                    <div class="w-10 h-10 mx-auto mb-1 bg-gray-800 rounded-full flex items-center justify-center text-white text-lg">
                        <i class="fab fa-github"></i>
                    </div>
                    <span class="font-semibold text-gray-700 text-xs block">GitHub</span>
                    <div class="mt-1 flex justify-center">
                        <span class="api-badge bg-gray-100 text-gray-700">Raw</span>
                    </div>
                </div>

                <!-- MediaFire -->
                <div class="platform-card bg-white rounded-xl p-3 text-center shadow-md" data-platform="mediafire">
                    <div class="w-10 h-10 mx-auto mb-1 bg-blue-500 rounded-full flex items-center justify-center text-white text-lg">
                        <i class="fas fa-fire"></i>
                    </div>
                    <span class="font-semibold text-gray-700 text-xs block">MediaFire</span>
                    <div class="mt-1 flex justify-center">
                        <span class="api-badge bg-blue-100 text-blue-700">API</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Input Section -->
        <div class="glass-effect rounded-2xl p-6 shadow-2xl mb-6">
            <div class="max-w-3xl mx-auto">
                <label class="block text-gray-700 font-semibold mb-2 text-sm sm:text-base">
                    <i class="fas fa-link mr-2 text-purple-600"></i>
                    <span id="inputLabel">URL</span> 
                    <span id="platformLabel" class="text-purple-600 bg-purple-100 px-2 py-1 rounded-full text-xs ml-2">YouTube</span>
                </label>
                
                <div class="relative">
                    <input type="text" id="urlInput" 
                           class="w-full px-4 py-3 rounded-xl border-2 border-gray-200 input-focus text-gray-700 text-sm sm:text-base pr-28"
                           placeholder="https://youtube.com/watch?v=...">
                    <button id="searchBtn" class="absolute right-2 top-2 bottom-2 download-btn text-white px-4 rounded-lg font-semibold text-sm flex items-center space-x-1">
                        <i class="fas fa-search"></i>
                        <span class="hidden sm:inline">Cari</span>
                    </button>
                </div>
                
                <div class="flex items-center justify-between mt-2">
                    <p class="text-xs text-gray-500">
                        <i class="fas fa-check-circle mr-1 text-green-500"></i>
                        <span id="hintText">Pilih format MP4 atau MP3</span>
                    </p>
                    <button id="pasteBtn" class="text-xs text-purple-600 hover:text-purple-800 font-medium">
                        <i class="fas fa-paste mr-1"></i>Paste
                    </button>
                </div>

                <!-- YouTube Format Selector -->
                <div id="ytSelector" class="mt-3 flex gap-2">
                    <button id="btnMp4" class="flex-1 py-2 rounded-lg bg-red-600 text-white text-sm font-semibold">
                        <i class="fas fa-video mr-1"></i>MP4 Video
                    </button>
                    <button id="btnMp3" class="flex-1 py-2 rounded-lg bg-gray-200 text-gray-700 text-sm font-semibold">
                        <i class="fas fa-music mr-1"></i>MP3 Audio
                    </button>
                </div>

                <!-- Spotify Search Results -->
                <div id="spotifyResults" class="hidden mt-4 space-y-2"></div>
            </div>
        </div>

        <!-- Loading -->
        <div id="loadingSection" class="hidden glass-effect rounded-2xl p-8 text-center shadow-2xl mb-6">
            <div class="loading-spinner mx-auto mb-3"></div>
            <h3 class="text-lg font-semibold text-gray-700 mb-1" id="loadingText">Menganalisis...</h3>
            <p class="text-sm text-gray-500" id="loadingSub">Menghubungi server...</p>
        </div>

        <!-- Results -->
        <div id="resultsSection" class="hidden glass-effect rounded-2xl p-4 sm:p-6 shadow-2xl">
            <div class="flex items-center justify-between mb-4 border-b pb-3">
                <div class="flex items-center space-x-2">
                    <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center text-green-600">
                        <i class="fas fa-check text-sm"></i>
                    </div>
                    <div>
                        <h3 class="font-bold text-gray-800 text-sm sm:text-base">Hasil</h3>
                        <p class="text-xs text-gray-500" id="usedApi">API</p>
                    </div>
                </div>
                <button id="closeResults" class="w-8 h-8 rounded-full hover:bg-red-50 text-gray-400 hover:text-red-500 transition">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="resultsContent" class="space-y-3"></div>
        </div>

        <!-- Error -->
        <div id="errorSection" class="hidden glass-effect rounded-2xl p-6 shadow-2xl border-l-4 border-red-500 mb-6">
            <div class="flex items-center space-x-2 mb-2">
                <i class="fas fa-exclamation-triangle text-red-500"></i>
                <h3 class="font-bold text-gray-800">Gagal</h3>
            </div>
            <p id="errorMessage" class="text-sm text-gray-600 mb-3">Terjadi kesalahan</p>
            <button id="retryBtn" class="bg-red-500 text-white px-4 py-2 rounded-lg text-sm hover:bg-red-600">
                <i class="fas fa-redo mr-1"></i>Coba Lagi
            </button>
        </div>

    </main>

    <!-- Footer -->
    <footer class="mt-12 bg-white bg-opacity-10 backdrop-blur-lg text-white py-6">
        <div class="container mx-auto px-4 text-center">
            <p class="text-sm mb-1">&copy; 2024 AllDownloader</p>
            <p class="text-xs opacity-75">Developed with ❤️ by Ridzz</p>
        </div>
    </footer>

    <script>
        // ============================================
        // CONFIGURATION
        // ============================================
        
        // GANTI DENGAN URL BACKEND ANDA
        const API_BASE = 'https://dwon.vercel.app/api';
        
        // ============================================
        // STATE
        // ============================================
        
        let currentPlatform = 'youtube';
        let lastUrl = '';
        let ytFormat = 'mp4';

        const platformConfig = {
            youtube: {
                label: 'URL',
                placeholder: 'https://youtube.com/watch?v=...',
                hint: 'Pilih format MP4 atau MP3',
                showYtSelector: true,
                showSpotifyResults: false
            },
            instagram: {
                label: 'URL',
                placeholder: 'https://instagram.com/p/... atau https://instagram.com/reel/...',
                hint: 'Scraping tanpa login',
                showYtSelector: false,
                showSpotifyResults: false
            },
            tiktok: {
                label: 'URL',
                placeholder: 'https://www.tiktok.com/@username/video/...',
                hint: 'Video tanpa watermark',
                showYtSelector: false,
                showSpotifyResults: false
            },
            twitter: {
                label: 'URL',
                placeholder: 'https://twitter.com/username/status/...',
                hint: 'Download video Twitter',
                showYtSelector: false,
                showSpotifyResults: false
            },
            pinterest: {
                label: 'URL',
                placeholder: 'https://pinterest.com/pin/...',
                hint: 'Scraping gambar/video',
                showYtSelector: false,
                showSpotifyResults: false
            },
            spotify: {
                label: 'Judul Lagu',
                placeholder: 'Contoh: Alan Walker Faded',
                hint: 'Cari lagu di YouTube',
                showYtSelector: false,
                showSpotifyResults: true
            },
            facebook: {
                label: 'URL',
                placeholder: 'https://facebook.com/watch?v=...',
                hint: 'Video Facebook HD/SD',
                showYtSelector: false,
                showSpotifyResults: false
            },
            gdrive: {
                label: 'URL',
                placeholder: 'https://drive.google.com/file/d/...',
                hint: 'Direct download Google Drive',
                showYtSelector: false,
                showSpotifyResults: false
            },
            github: {
                label: 'URL',
                placeholder: 'https://github.com/user/repo/blob/main/file.txt',
                hint: 'Download file dari repository',
                showYtSelector: false,
                showSpotifyResults: false
            },
            mediafire: {
                label: 'URL',
                placeholder: 'https://mediafire.com/file/...',
                hint: 'Direct download file',
                showYtSelector: false,
                showSpotifyResults: false
            }
        };

        // ============================================
        // INITIALIZATION
        // ============================================
        
        document.addEventListener('DOMContentLoaded', function() {
            // Attach platform click events
            document.querySelectorAll('.platform-card').forEach(card => {
                card.addEventListener('click', function() {
                    const platform = this.getAttribute('data-platform');
                    selectPlatform(platform, this);
                });
            });
            
            // Attach events
            document.getElementById('searchBtn').addEventListener('click', startDownload);
            document.getElementById('urlInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') startDownload();
            });
            document.getElementById('pasteBtn').addEventListener('click', pasteFromClipboard);
            document.getElementById('btnMp4').addEventListener('click', () => setYtFormat('mp4'));
            document.getElementById('btnMp3').addEventListener('click', () => setYtFormat('mp3'));
            document.getElementById('closeResults').addEventListener('click', clearResults);
            document.getElementById('retryBtn').addEventListener('click', retryDownload);
            
            // Set initial active
            document.querySelector('[data-platform="youtube"]').classList.add('active');
        });

        // ============================================
        // UI FUNCTIONS
        // ============================================
        
        function selectPlatform(platform, el) {
            // Clear
            document.getElementById('urlInput').value = '';
            clearResults();
            
            currentPlatform = platform;
            
            // Update active state
            document.querySelectorAll('.platform-card').forEach(c => c.classList.remove('active'));
            el.classList.add('active');
            
            // Update UI
            const config = platformConfig[platform];
            document.getElementById('inputLabel').textContent = config.label;
            document.getElementById('platformLabel').textContent = platform.charAt(0).toUpperCase() + platform.slice(1);
            document.getElementById('urlInput').placeholder = config.placeholder;
            document.getElementById('hintText').textContent = config.hint;
            
            // Show/hide selectors
            document.getElementById('ytSelector').style.display = config.showYtSelector ? 'flex' : 'none';
            document.getElementById('spotifyResults').style.display = config.showSpotifyResults ? 'block' : 'none';
            document.getElementById('spotifyResults').classList.toggle('hidden', !config.showSpotifyResults);
            
            if (platform === 'youtube') setYtFormat('mp4');
        }

        function setYtFormat(fmt) {
            ytFormat = fmt;
            document.getElementById('btnMp4').className = fmt === 'mp4' 
                ? 'flex-1 py-2 rounded-lg bg-red-600 text-white text-sm font-semibold'
                : 'flex-1 py-2 rounded-lg bg-gray-200 text-gray-700 text-sm font-semibold';
            document.getElementById('btnMp3').className = fmt === 'mp3'
                ? 'flex-1 py-2 rounded-lg bg-red-600 text-white text-sm font-semibold'
                : 'flex-1 py-2 rounded-lg bg-gray-200 text-gray-700 text-sm font-semibold';
        }

        async function pasteFromClipboard() {
            try {
                const text = await navigator.clipboard.readText();
                document.getElementById('urlInput').value = text;
                showToast('URL dipaste!', 'success');
            } catch (err) {
                showToast('Clipboard tidak diizinkan', 'error');
            }
        }

        // ============================================
        // API CALLS
        // ============================================
        
        async function fetchAPI(endpoint, params) {
            const url = new URL(`${API_BASE}${endpoint}`);
            Object.keys(params).forEach(key => url.searchParams.append(key, params[key]));
            
            const response = await fetch(url);
            if (!response.ok) {
                const error = await response.json();
                throw new Error(error.error || 'API Error');
            }
            return response.json();
        }

        // ============================================
        // MAIN FUNCTION
        // ============================================
        
        async function startDownload() {
            const input = document.getElementById('urlInput').value.trim();
            if (!input) {
                showToast('Masukkan ' + platformConfig[currentPlatform].label + '!', 'error');
                return;
            }
            
            lastUrl = input;
            document.getElementById('loadingSection').classList.remove('hidden');
            document.getElementById('resultsSection').classList.add('hidden');
            document.getElementById('errorSection').classList.add('hidden');
            
            try {
                let data;
                
                switch(currentPlatform) {
                    case 'youtube':
                        document.getElementById('loadingSub').textContent = `Scraping YouTube ${ytFormat.toUpperCase()}...`;
                        data = await fetchAPI('/youtube', { url: input, format: ytFormat });
                        break;
                        
                    case 'instagram':
                        document.getElementById('loadingSub').textContent = 'Scraping Instagram...';
                        data = await fetchAPI('/instagram', { url: input });
                        break;
                        
                    case 'tiktok':
                        document.getElementById('loadingSub').textContent = 'Mengambil dari TikTok API...';
                        data = await fetchAPI('/tiktok', { url: input });
                        break;
                        
                    case 'twitter':
                        document.getElementById('loadingSub').textContent = 'Mengambil dari Twitter API...';
                        data = await fetchAPI('/twitter', { url: input });
                        break;
                        
                    case 'pinterest':
                        document.getElementById('loadingSub').textContent = 'Scraping Pinterest...';
                        data = await fetchAPI('/pinterest', { url: input });
                        break;
                        
                    case 'spotify':
                        document.getElementById('loadingSub').textContent = 'Mencari di YouTube...';
                        data = await fetchAPI('/spotify', { q: input });
                        showSpotifyResults(data);
                        document.getElementById('loadingSection').classList.add('hidden');
                        return;
                        
                    case 'facebook':
                        document.getElementById('loadingSub').textContent = 'Mengambil dari Facebook API...';
                        data = await fetchAPI('/facebook', { url: input });
                        break;
                        
                    case 'gdrive':
                        document.getElementById('loadingSub').textContent = 'Processing Google Drive...';
                        data = await fetchAPI('/gdrive', { url: input });
                        break;
                        
                    case 'github':
                        document.getElementById('loadingSub').textContent = 'Processing GitHub...';
                        data = await fetchAPI('/github', { url: input });
                        break;
                        
                    case 'mediafire':
                        document.getElementById('loadingSub').textContent = 'Mengambil dari MediaFire API...';
                        data = await fetchAPI('/mediafire', { url: input });
                        break;
                }
                
                document.getElementById('loadingSection').classList.add('hidden');
                showResults(data);
                showToast('Berhasil!', 'success');
                
            } catch (err) {
                console.error('Error:', err);
                document.getElementById('loadingSection').classList.add('hidden');
                document.getElementById('errorSection').classList.remove('hidden');
                document.getElementById('errorMessage').textContent = err.message;
                showToast('Gagal: ' + err.message, 'error');
            }
        }

        // ============================================
        // RENDER FUNCTIONS
        // ============================================
        
        function showResults(data) {
            const div = document.getElementById('resultsSection');
            const content = document.getElementById('resultsContent');
            div.classList.remove('hidden');
            
            let html = '';
            
            switch(currentPlatform) {
                case 'youtube':
                    html = `
                        <div class="result-card bg-white rounded-xl p-4 shadow border-l-4 border-red-600">
                            <div class="flex gap-4">
                                <div class="w-24 h-24 flex-shrink-0 bg-gray-100 rounded-lg overflow-hidden">
                                    <img src="${data.thumbnail}" class="w-full h-full object-cover" onerror="this.src='https://via.placeholder.com/100'">
                                </div>
                                <div class="flex-1 min-w-0">
                                    <h4 class="font-bold text-gray-800 text-sm line-clamp-2 mb-2">${data.title}</h4>
                                    <p class="text-xs text-gray-500 mb-1">${data.uploader}</p>
                                    <span class="${data.format === 'mp3' ? 'bg-orange-500' : 'bg-green-500'} text-white px-2 py-1 rounded-full text-xs">${data.quality}</span>
                                    <a href="${data.download_url}" download class="mt-2 block w-full download-btn text-white py-2 rounded-lg text-center text-sm font-semibold">
                                        <i class="fas fa-download mr-1"></i>Unduh ${data.format.toUpperCase()}
                                    </a>
                                </div>
                            </div>
                        </div>`;
                    break;
                    
                case 'instagram':
                    html = `
                        <div class="result-card bg-white rounded-xl p-4 shadow">
                            <h4 class="font-bold text-gray-800 mb-3 text-sm">${data.items.length} Media Ditemukan</h4>
                            <div class="grid grid-cols-2 sm:grid-cols-3 gap-2">
                                ${data.items.map((item, i) => `
                                    <div class="relative aspect-square bg-gray-100 rounded-lg overflow-hidden group">
                                        <img src="${item.thumbnail}" class="w-full h-full object-cover" loading="lazy" onerror="this.parentElement.innerHTML='<div class=\'flex items-center justify-center h-full text-gray-400\'><i class=\'fas fa-image\'></i></div>'">
                                        <div class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 transition flex items-center justify-center">
                                            <a href="${item.url}" download class="opacity-0 group-hover:opacity-100 bg-white text-gray-800 px-3 py-2 rounded-full text-sm font-semibold">
                                                <i class="fas fa-download"></i>
                                            </a>
                                        </div>
                                        <div class="absolute top-1 right-1 bg-black text-white text-xs px-1 rounded">${i + 1}</div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>`;
                    break;
                    
                case 'tiktok':
                    html = `
                        <div class="result-card bg-white rounded-xl p-4 shadow">
                            <div class="flex flex-col sm:flex-row gap-4">
                                <div class="sm:w-1/3">
                                    <div class="aspect-[9/16] bg-gray-100 rounded-lg overflow-hidden">
                                        <img src="${data.thumbnail}" class="w-full h-full object-cover">
                                    </div>
                                </div>
                                <div class="sm:w-2/3 space-y-3">
                                    <h4 class="font-bold text-gray-800 text-sm">${data.title}</h4>
                                    <p class="text-xs text-gray-500">${data.author || '@user'}</p>
                                    <div class="grid grid-cols-2 gap-2">
                                        <a href="${data.video_url}" download class="download-btn text-white py-2 rounded-lg text-center text-sm font-semibold block">
                                            <i class="fas fa-video mr-1"></i>Video
                                        </a>
                                        ${data.audio_url ? `
                                        <a href="${data.audio_url}" download class="bg-gray-100 text-gray-700 py-2 rounded-lg text-center text-sm font-semibold hover:bg-gray-200 block">
                                            <i class="fas fa-music mr-1"></i>Audio
                                        </a>` : ''}
                                    </div>
                                </div>
                            </div>
                        </div>`;
                    break;
                    
                case 'twitter':
                    html = `
                        <div class="result-card bg-white rounded-xl p-4 shadow border-l-4 border-blue-400">
                            <div class="flex gap-4">
                                <div class="w-24 h-24 flex-shrink-0 bg-gray-100 rounded-lg overflow-hidden">
                                    <img src="${data.thumbnail}" class="w-full h-full object-cover" onerror="this.style.display='none'">
                                </div>
                                <div class="flex-1 min-w-0">
                                    <h4 class="font-bold text-gray-800 text-sm line-clamp-2 mb-2">${data.title}</h4>
                                    <p class="text-xs text-gray-500 mb-1">${data.duration}</p>
                                    ${data.formats ? data.formats.map(f => `
                                        <a href="${f.url}" download class="mt-1 block w-full bg-blue-50 text-blue-700 py-2 rounded-lg text-center text-sm font-semibold border border-blue-200">
                                            Download ${f.quality}
                                        </a>
                                    `).join('') : `
                                        <a href="${data.download_url}" download class="mt-2 block w-full download-btn text-white py-2 rounded-lg text-center text-sm font-semibold">
                                            <i class="fas fa-download mr-1"></i>Download Video
                                        </a>
                                    `}
                                </div>
                            </div>
                        </div>`;
                    break;
                    
                case 'pinterest':
                    html = `
                        <div class="result-card bg-white rounded-xl p-4 shadow border-l-4 border-red-700">
                            <div class="flex flex-col sm:flex-row gap-4">
                                <div class="sm:w-1/2">
                                    <div class="aspect-square bg-gray-100 rounded-lg overflow-hidden">
                                        <img src="${data.thumbnail}" class="w-full h-full object-cover">
                                    </div>
                                </div>
                                <div class="sm:w-1/2 space-y-4">
                                    <h4 class="font-bold text-gray-800 text-sm line-clamp-3">${data.title}</h4>
                                    ${data.video_url ? `
                                    <a href="${data.video_url}" download class="block w-full bg-red-600 text-white py-2 rounded-lg text-center text-sm font-semibold">
                                        <i class="fas fa-video mr-1"></i>Download Video
                                    </a>` : ''}
                                    <a href="${data.image_url}" download class="block w-full download-btn text-white py-3 rounded-lg text-center font-semibold">
                                        <i class="fas fa-download mr-2"></i>Download Image
                                    </a>
                                </div>
                            </div>
                        </div>`;
                    break;
                    
                case 'facebook':
                    html = `
                        <div class="result-card bg-white rounded-xl p-4 shadow border-l-4 border-blue-600">
                            <h4 class="font-bold text-gray-800 text-sm mb-3 line-clamp-2">${data.title}</h4>
                            ${data.thumbnail ? `
                            <div class="mb-3 aspect-video bg-gray-100 rounded-lg overflow-hidden">
                                <img src="${data.thumbnail}" class="w-full h-full object-cover">
                            </div>` : ''}
                            <div class="grid grid-cols-2 gap-2">
                                ${data.formats.map(f => `
                                    <a href="${f.url}" download class="bg-blue-50 border-2 border-blue-200 hover:border-blue-400 rounded-lg p-3 text-center transition block">
                                        <div class="font-bold text-blue-700 text-lg">${f.quality}</div>
                                        <div class="text-xs text-blue-500">Download</div>
                                    </a>
                                `).join('')}
                            </div>
                        </div>`;
                    break;
                    
                case 'gdrive':
                    html = `
                        <div class="result-card bg-white rounded-xl p-4 shadow border-l-4 border-green-600">
                            <div class="flex items-center gap-3 mb-3">
                                <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center text-green-600">
                                    <i class="fab fa-google-drive text-xl"></i>
                                </div>
                                <div class="flex-1 min-w-0">
                                    <h4 class="font-bold text-gray-800 text-sm truncate">${data.filename}</h4>
                                    <p class="text-xs text-gray-500">Google Drive</p>
                                </div>
                            </div>
                            <a href="${data.download_url}" download class="block w-full download-btn text-white py-3 rounded-lg text-center font-semibold">
                                <i class="fas fa-cloud-download-alt mr-2"></i>Download File
                            </a>
                        </div>`;
                    break;
                    
                case 'github':
                    html = `
                        <div class="result-card bg-white rounded-xl p-4 shadow border-l-4 border-gray-800">
                            <div class="flex items-center gap-3 mb-3">
                                <div class="w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center text-gray-800">
                                    <i class="fab fa-github text-xl"></i>
                                </div>
                                <div class="flex-1 min-w-0">
                                    <h4 class="font-bold text-gray-800 text-sm truncate">${data.filename}</h4>
                                    <p class="text-xs text-gray-500">${data.size || 'Unknown size'}</p>
                                </div>
                            </div>
                            <a href="${data.download_url}" download class="block w-full bg-gray-800 text-white py-3 rounded-lg text-center font-semibold hover:bg-gray-900">
                                <i class="fas fa-download mr-2"></i>Download File
                            </a>
                        </div>`;
                    break;
                    
                case 'mediafire':
                    html = `
                        <div class="result-card bg-white rounded-xl p-4 shadow border-l-4 border-blue-500">
                            <div class="flex items-center gap-3 mb-3">
                                <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center text-blue-600">
                                    <i class="fas fa-file-archive text-xl"></i>
                                </div>
                                <div class="flex-1 min-w-0">
                                    <h4 class="font-bold text-gray-800 text-sm truncate">${data.filename}</h4>
                                    <p class="text-xs text-gray-500">${data.size}</p>
                                </div>
                            </div>
                            <a href="${data.download_url}" download class="block w-full download-btn text-white py-3 rounded-lg text-center font-semibold">
                                <i class="fas fa-cloud-download-alt mr-2"></i>Download File
                            </a>
                        </div>`;
                    break;
            }
            
            content.innerHTML = html;
            document.getElementById('usedApi').textContent = 'Via: ' + currentPlatform;
            div.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // ============================================
        // SPOTIFY SEARCH RESULTS
        // ============================================
        
        function showSpotifyResults(data) {
            const container = document.getElementById('spotifyResults');
            container.classList.remove('hidden');
            
            container.innerHTML = `
                <h4 class="font-bold text-gray-800 mb-2 text-sm">Hasil Pencarian untuk "${data.query}"</h4>
                <div class="space-y-2 max-h-64 overflow-y-auto">
                    ${data.results.map((song, i) => `
                        <div class="bg-white rounded-lg p-3 shadow flex gap-3 items-center">
                            <div class="w-12 h-12 bg-gray-100 rounded-lg overflow-hidden flex-shrink-0">
                                <img src="${song.thumbnail}" class="w-full h-full object-cover" onerror="this.style.display='none'">
                            </div>
                            <div class="flex-1 min-w-0">
                                <h5 class="font-semibold text-gray-800 text-xs truncate">${song.title}</h5>
                                <p class="text-xs text-gray-500 truncate">${song.uploader}</p>
                            </div>
                            <button onclick="downloadSpotifySong('${song.url}')" class="bg-green-500 text-white px-3 py-1 rounded-full text-xs font-semibold hover:bg-green-600">
                                <i class="fas fa-download"></i>
                            </button>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        async function downloadSpotifySong(youtubeUrl) {
            document.getElementById('loadingSection').classList.remove('hidden');
            document.getElementById('loadingSub').textContent = 'Mengambil audio...';
            
            try {
                const data = await fetchAPI('/youtube', { url: youtubeUrl, format: 'mp3' });
                document.getElementById('loadingSection').classList.add('hidden');
                
                // Show result
                const div = document.getElementById('resultsSection');
                const content = document.getElementById('resultsContent');
                div.classList.remove('hidden');
                
                content.innerHTML = `
                    <div class="result-card bg-white rounded-xl p-4 shadow border-l-4 border-green-500">
                        <div class="flex gap-4 items-center">
                            <div class="w-20 h-20 bg-gray-100 rounded-lg overflow-hidden flex-shrink-0">
                                <img src="${data.thumbnail}" class="w-full h-full object-cover">
                            </div>
                            <div class="flex-1 min-w-0">
                                <h4 class="font-bold text-gray-800 text-sm truncate">${data.title}</h4>
                                <p class="text-xs text-gray-500 mb-2">${data.uploader}</p>
                                <a href="${data.download_url}" download class="inline-flex items-center download-btn text-white px-4 py-2 rounded-full text-sm font-semibold">
                                    <i class="fas fa-download mr-2"></i>Unduh MP3
                                </a>
                            </div>
                        </div>
                    </div>
                `;
                
                document.getElementById('usedApi').textContent = 'Via: YouTube (Spotify Search)';
                showToast('Berhasil!', 'success');
                
            } catch (err) {
                document.getElementById('loadingSection').classList.add('hidden');
                showToast('Gagal: ' + err.message, 'error');
            }
        }

        function clearResults() {
            document.getElementById('resultsSection').classList.add('hidden');
            document.getElementById('errorSection').classList.add('hidden');
            document.getElementById('spotifyResults').classList.add('hidden');
        }

        function retryDownload() {
            if (lastUrl) {
                document.getElementById('urlInput').value = lastUrl;
                startDownload();
            }
        }

        function showToast(msg, type = 'success') {
            const toast = document.getElementById('toast');
            const icon = document.getElementById('toastIcon');
            const text = document.getElementById('toastMessage');
            
            text.textContent = msg;
            icon.className = `fas ${
                type === 'error' ? 'fa-exclamation-circle text-red-500' : 
                type === 'info' ? 'fa-info-circle text-blue-500' : 
                'fa-check-circle text-green-500'
            } text-xl`;
            
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }
    </script>

</body>
</html>
